<%- include('../../views/partials/user/header.ejs') %>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

<link rel="stylesheet" href="/css/user/shop/userProfile.css">

<div class="container py-5 ">

  <h3 class="fw-semibold mb-4">My Account</h3>

  <div class="row g-4">

    <!-- SIDEBAR -->
    <div class="col-md-3">
      <div class="sidebar">
        <a class="active"><i class="bi bi-person"></i> Profile</a>
        <a><i class="bi bi-box"></i> Orders</a>
        <a><i class="bi bi-house"></i> Addresses</a>
        <a><i class="bi bi-heart"></i> Wishlist</a>
        <a><i class="bi bi-wallet2"></i> Wallet</a>
        <a class="text-danger"><i class="bi bi-box-arrow-right"></i> Logout</a>
      </div>
    </div>

    <!-- PROFILE -->
    <div class="col-md-9">
      <div class="profile-card">

        <!-- HEADER -->
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h5 class="fw-semibold">Personal Information</h5>
          <button class="btn btn-link" id="editBtn" style="text-decoration: none;">Edit</button>
        </div>

        <form id="profileForm"  enctype="multipart/form-data">
        <!-- PROFILE IMAGE -->
        <div class="d-flex align-items-center gap-4 mb-4">
          <div class="profile-img-wrapper">
            <img
               src="<%= locals.user.profileImage || `https://ui-avatars.com/api/?name=${encodeURIComponent(locals.user.name)}&background=E5C8B8&color=2B2B2B` %>"
              id="profileImage"
              class="profile-img"
            >
            

            <button type="button" class="edit-img-btn d-none" id="editImageBtn">
            <i class="bi bi-camera"></i>
            </button>

            <input type="file" id="imageInput" name="profileImage" class="d-none" accept="image/*"/>
            <small class="text-danger d-none" id="imageError"></small>
          </div>
          

          <div>
            <h6 class="mb-1"><%=user.name%></h6>
            <small class="text-muted">Profile Photo</small>
          </div>
        </div>

       
        

          <div class="mb-3">
            <label class="form-label">Full Name</label>
            <input type="text" name="fullName" class="form-control" value="<%=user.name%>" readonly>
            <small class="text-danger d-none" id="nameError"></small>
          </div>

          <div class="mb-3">
            <label class="form-label">Email Address</label>
            <input type="email" name="email" class="form-control" value="<%=user.email%>" readonly>
            <small class="text-danger d-none" id="emailError"></small>
          </div>

          <div class="mb-3">
            <label class="form-label">Phone Number</label>
            <input type="text" name="phone" class="form-control" value="<%=user.phone%>" readonly>
            <small class="text-danger d-none" id="phoneError"></small>
          </div>

       
          <!-- ACTION BUTTONS -->
          <div class="d-flex justify-content-end gap-3 d-none" id="actionButtons">
            <button type="button" class="btn btn-outline-secondary" id="cancelBtn">
              Cancel
            </button>
            <button type="submit" class="btn" style="background:#e5c8b8;">
              Save Changes
            </button>
          </div>

        </form>

        <hr>

        <!-- CHANGE PASSWORD -->
        <!-- CHANGE PASSWORD -->
<div>
  <h6 class="section-title mb-3">Change Password</h6>

  <form id="changePasswordForm">
    <div class="mb-3">
      <label class="form-label small">Current Password</label>      
      <input type="password" id="currentPassword" class="form-control">
      <small class="text-danger d-none" id="oldpasswoedError"></small>
    </div>

    <div class="mb-3">
      <label class="form-label small">New Password</label>
      <input type="password" id="newPassword" class="form-control">
      <small class="text-danger d-none" id="newpasswordError"></small>
    </div>

    <div class="mb-4">
      <label class="form-label small">Confirm New Password</label>
      <input type="password" id="confirmPassword" class="form-control">
      <small class="text-danger d-none" id="confirmpassword"></small>
    </div>

    <button type="submit" class="btn" style="background:#e5c8b8;">
      Update Password
    </button>
  </form>
</div>

      </div>
    </div>

  </div>
</div>

<script src="/js/user/shop/userProfile.js"></script>
<%- include('../../views/partials/user/footer.ejs') %>